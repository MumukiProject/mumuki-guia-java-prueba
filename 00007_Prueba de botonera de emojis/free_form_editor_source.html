<div class="btn-group" role="group" aria-label="Emojis">
  <button type="button" class="btn btn-secondary" onclick="writeEmoji('ðŸŽ¹')">ðŸŽ¹</button>
  <button type="button" class="btn btn-secondary" onclick="writeEmoji('ðŸ’œ')">ðŸ’œ</button>
  <button type="button" class="btn btn-secondary" onclick="writeEmoji('ðŸ”¥')">ðŸ”¥</button>
</div>
<div class="form-horizontal">
  <div class="form-group">
    <div class="input-group">
      <div class="input-group-addon">Mensaje encriptado</div>
      <input id="emojis_message" name="emojis_message" type="text" class="form-control mu-free-form-input" onfocus="this.value = this.value;" placeholder="Emojis" onblur="restoreCursorPosition()">
    </div>
  </div>
</div>


<script>
var emojiCursorStart, emojiCursorEnd;
function writeEmoji(emoji) {
  var emojisInput = $('#emojis_message');
  emojiCursorStart = emojisInput.prop('selectionStart');
  emojiCursorEnd = emojisInput.prop('selectionEnd');
  var v = emojisInput.val() || '';
  var textBefore = v.substring(0,  emojiCursorStart);
  var textAfter  = v.substring(emojiCursorEnd, v.length);
  emojisInput.val(textBefore + emoji + textAfter);
  $('#emojis_message.mu-free-form-input').change();
}

function restoreCursorPosition() {
  $('#emojis_message').prop('selectionStart', emojiCursorStart);
  $('#emojis_message').prop('selectionEnd', emojiCursorEnd)
}
</script>

